apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: backtrade

resources:
    # Core infrastructure
    - namespace.yaml

    # ConfigMaps
    - configmaps/nginx-proxy-config.yaml
    - configmaps/nginx-frontend-config.yaml

    # Secrets
    - secrets/secrets.yaml

    # Database
    - postgres/statefulset.yaml
    - postgres/service.yaml

    # Redis
    - redis/deployment.yaml
    - redis/service.yaml

    # Backend
    - backend/deployment.yaml
    - backend/service.yaml

    # Frontend
    - frontend/deployment.yaml
    - frontend/service.yaml

    # Proxy
    - proxy/deployment.yaml
    - proxy/service.yaml

    # Cloudflared
    - cloudflared/deployment.yaml

    # Ingress
    - ingress/ingress.yaml

    # Autoscaling
    - hpa/backend-hpa.yaml
    - hpa/frontend-hpa.yaml

# Image configuration - set your image registry here
images:
    - name: backtrade-api
      newName: reichhartdamien/backtrade-api
      newTag: v1.0.0
    - name: backtrade-frontend
      newName: reichhartdamien/backtrade-frontend
      newTag: v1.0.0
