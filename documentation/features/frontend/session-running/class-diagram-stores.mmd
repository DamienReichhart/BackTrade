classDiagram
    class CurrentSessionStore {
        -currentSession: Session | undefined
        -currentSessionInstrument: Instrument | undefined
        +setCurrentSession(session: Session | undefined): void
        +setCurrentSessionInstrument(instrument: Instrument | undefined): void
        +clearCurrentSession(): void
    }
    
    class CurrentPriceStore {
        -currentPrice: number | undefined
        +setCurrentPrice(price: number | undefined): void
    }
    
    class CurrentSessionCandlesStore {
        -candles: Candle[]
        +setCandles(candles: Candle[]): void
        +clearCandles(): void
    }
    
    class ChartSettingsStore {
        -vertLines: boolean
        -horzLines: boolean
        -timeVisible: boolean
        -secondsVisible: boolean
        -timeframe: Timeframe
        +setVertLines(visible: boolean): void
        +setHorzLines(visible: boolean): void
        +setTimeVisible(visible: boolean): void
        +setSecondsVisible(visible: boolean): void
        +setTimeframe(timeframe: Timeframe): void
        +updateSettings(settings: Partial~ChartGridSettings~): void
        +getSettings(): ChartGridSettings
    }
    
    class IndicatorSettingsStore {
        -indicators: IndicatorConfig[]
        +addIndicator(type: IndicatorType): IndicatorConfig | null
        +updateIndicator(id: string, changes: Partial~IndicatorConfig~): void
        +removeIndicator(id: string): void
        +toggleIndicator(id: string): void
        +duplicateIndicator(id: string): void
        +reorderIndicator(id: string, direction: "up" | "down"): void
        +replaceIndicators(next: IndicatorConfig[]): void
        +reset(): void
    }
    
    class Session {
        +id: number
        +name: string
        +session_status: "RUNNING" | "PAUSED" | "ARCHIVED"
        +current_ts: string
        +end_ts: string | null
        +speed_multiplier: number
        +instrument_id: number
        +spread_pts: number
        +slippage_pts: number
        +commission_per_fill: number
    }
    
    class Instrument {
        +id: number
        +symbol: string
        +pip_size: number
    }
    
    class Candle {
        +timestamp: string
        +open: number
        +high: number
        +low: number
        +close: number
        +volume: number
    }
    
    class IndicatorConfig {
        +id: string
        +type: IndicatorType
        +name: string
        +isEnabled: boolean
        +order: number
        +period: number
        +source: "open" | "high" | "low" | "close"
        +color: string
        +lineWidth: number
    }
    
    CurrentSessionStore --> Session : contains
    CurrentSessionStore --> Instrument : contains
    CurrentPriceStore --> Candle : derives from
    CurrentSessionCandlesStore --> Candle : contains array
    IndicatorSettingsStore --> IndicatorConfig : contains array

